<!DOCTYPE html>
<html>
<head>
    <title>Phaser Racer</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
    </style>
</head>
<body>
    <script>
        const config = {
            type: Phaser.AUTO,
            width: 900,
            height: 700,
            physics: {
                default: 'arcade',
                arcade: { debug: false }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        const game = new Phaser.Game(config);
        let car, cursors;
        let trackGraphics;
        
        // Track configuration
        const trackConfig = {
            outer: { x: 450, y: 350, width: 600, height: 500 },
            inner: { x: 450, y: 350, width: 400, height: 300 },
            color: 0x444444
        };

        function preload() {
            this.load.image('car', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAjCAYAAABvR7Y6AAAABmJLR0QA/wD/AP+AdzggAAAAtUlEQVRIx2P4DwQYGPg/oP/v37/vP7/7N0yAhkGGYVhw4CAzMP0DA+MPGhpGA0jA8AwMDB9m/3///j9wMQYGBq4MDAz/h4H7+Q8QJgx4/w8DAwMDD+fPfx+wMTAwMPIwMDD8P31gwPDv/wMMDAxg/Pz+gZGBAR/2vP+BgeG/s/T/oJGhgaGDkYGB4R8GBgb2f2BiYGBgYMDAwMBiQzUoGwY4DAwMWBgYAAB111V0xW5+76gAAAABJRU5ErkJggg==');
        }

        function create() {
            // Draw track
            trackGraphics = this.add.graphics();
            drawTrack();
            
            // Create car
            car = this.physics.add.sprite(450, 600, 'car')
                .setAngle(-90)
                .setScale(0.5)
                .setDrag(0.25)
                .setMaxVelocity(300);

            // Set up controls
            cursors = this.input.keyboard.createCursorKeys();
            
            // Set collision area
            this.physics.world.setBounds(0, 0, 900, 700);
        }

        function drawTrack() {
            // Draw grass background
            trackGraphics.fillStyle(0x228B22);
            trackGraphics.fillRect(0, 0, 900, 700);
            
            // Draw track
            trackGraphics.fillStyle(trackConfig.color);
            trackGraphics.fillRoundedRect(
                trackConfig.outer.x - trackConfig.outer.width/2,
                trackConfig.outer.y - trackConfig.outer.height/2,
                trackConfig.outer.width,
                trackConfig.outer.height,
                50
            );
            
            // Cut out inner area
            trackGraphics.fillStyle(0x228B22);
            trackGraphics.fillRoundedRect(
                trackConfig.inner.x - trackConfig.inner.width/2,
                trackConfig.inner.y - trackConfig.inner.height/2,
                trackConfig.inner.width,
                trackConfig.inner.height,
                30
            );
        }

        function update() {
            // Handle acceleration
            if (cursors.up.isDown) {
                this.physics.velocityFromRotation(car.rotation, 300, car.body.acceleration);
            } else if (cursors.down.isDown) {
                this.physics.velocityFromRotation(car.rotation, -150, car.body.acceleration);
            } else {
                car.setAcceleration(0);
            }

            // Handle steering
            const turnSpeed = Phaser.Math.Clamp(car.body.speed * 0.05, 0.5, 3);
            if (cursors.left.isDown) {
                car.setAngularVelocity(-turnSpeed * 100);
            } else if (cursors.right.isDown) {
                car.setAngularVelocity(turnSpeed * 100);
            } else {
                car.setAngularVelocity(0);
            }

            // Keep car on track
            const bounds = trackConfig.outer;
            const withinTrack = car.x > bounds.x - bounds.width/2 + 40 &&
                              car.x < bounds.x + bounds.width/2 - 40 &&
                              car.y > bounds.y - bounds.height/2 + 40 &&
                              car.y < bounds.y + bounds.height/2 - 40;
            
            if (!withinTrack) {
                car.setVelocity(car.body.velocity.x * 0.8, car.body.velocity.y * 0.8);
            }
        }
    </script>
</body>
</html>
